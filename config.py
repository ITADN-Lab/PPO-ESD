import numpy as np

# 电网基础数据
Bus = np.array([
    [1, 0, 0], [2, 100, 60], [3, 90, 40], [4, 120, 80], [5, 60, 30],
    [6, 60, 20], [7, 200, 100], [8, 200, 100], [9, 60, 20], [10, 60, 20],
    [11, 45, 30], [12, 60, 35], [13, 60, 35], [14, 120, 80], [15, 60, 10],
    [16, 60, 20], [17, 60, 20], [18, 90, 40], [19, 90, 40], [20, 90, 40],
    [21, 90, 40], [22, 90, 40], [23, 90, 40], [24, 420, 200], [25, 420, 200],
    [26, 60, 25], [27, 60, 25], [28, 60, 20], [29, 120, 70], [30, 200, 600],
    [31, 150, 70], [32, 210, 100], [33, 60, 40]
], dtype=float)

Branch = np.array([
    [1, 1, 2, 0.0922, 0.0407], [2, 2, 3, 0.4930, 0.2511], [3, 3, 4, 0.3660, 0.1864],
    [4, 4, 5, 0.3811, 0.1941], [5, 5, 6, 0.8190, 0.7070], [6, 6, 7, 0.1872, 0.6188],
    [7, 7, 8, 0.7144, 0.2351], [8, 8, 9, 1.0300, 0.7400], [9, 9, 10, 1.0440, 0.7400],
    [10, 10, 11, 0.1966, 0.065], [11, 11, 12, 0.3744, 0.1238], [12, 12, 13, 1.4680, 1.1550],
    [13, 13, 14, 0.5416, 0.7129], [14, 14, 15, 0.5910, 0.5260], [15, 15, 16, 0.7463, 0.5450],
    [16, 16, 17, 1.2890, 1.7210], [17, 17, 18, 0.7320, 0.5740], [18, 2, 19, 0.1640, 0.1565],
    [19, 19, 20, 1.5042, 1.3554], [20, 20, 21, 0.4095, 0.4784], [21, 21, 22, 0.7089, 0.9373],
    [22, 3, 23, 0.4512, 0.3083], [23, 23, 24, 0.8980, 0.7091], [24, 24, 25, 0.8960, 0.7011],
    [25, 6, 26, 0.2030, 0.1034], [26, 26, 27, 0.2842, 0.1447], [27, 27, 28, 1.0590, 0.9337],
    [28, 28, 29, 0.8042, 0.7006], [29, 29, 30, 0.5075, 0.2585], [30, 30, 31, 0.9744, 0.9630],
    [31, 31, 32, 0.3105, 0.3619], [32, 32, 33, 0.3410, 0.5302]
])

# 基础参数
Vbase = 12.66  # kV
Sbase = 100.0  # MVA
Zbase = Vbase ** 2 / Sbase

# 负载系数
coefficients = 1.0 * np.array([0.25, 0.2, 0.15, 0.1, 0.05, 0.05, 0.2, 0.3, 0.4, 0.55,
                               0.6, 0.7, 0.75, 0.7, 0.65, 0.62, 0.75, 0.8, 0.9, 0.95,
                               1.0, 0.8, 0.7, 0.4])

# 生成负载数据
bus_lists = []
for coeff in coefficients:
    new_bus = Bus.copy()
    new_bus[:, 1] *= coeff
    new_bus[:, 2] *= coeff
    bus_lists.append(new_bus)

# 默认光伏配置
DEFAULT_PV_CONFIG = {
    18: 2.00,
    25: 2.00,
    12: 2.00,
    30: 2.00
}

# 绘图配置
PLOT_CONFIG = {
    'font.family': 'serif',
    'font.serif': ['Times New Roman'],
    'font.size': 18,
    'axes.labelsize': 20,
    'axes.titlesize': 18,
    'xtick.labelsize': 18,
    'ytick.labelsize': 20,
    'legend.fontsize': 15,
    'figure.dpi': 300,
    'figure.figsize': (8, 4.5),
    'savefig.format': 'png',
    'savefig.bbox': 'tight',
    'axes.grid': True,
    'grid.alpha': 0.2,
    'grid.linestyle': '--'
}

# 保存路径
SAVE_DIR = r"E:\UJN研究生代码\SCI代码\结果图\分组测试"